# PulseOne í†µí•© ì•„í‚¤í…ì²˜ ê°„ë‹¨ í…ŒìŠ¤íŠ¸
CXX = g++
CXXFLAGS = -std=c++17 -Wall -Wextra -O2 -g
INCLUDES = -Iinclude

# ìƒ‰ìƒ ì •ì˜
GREEN = \033[0;32m
BLUE = \033[0;34m  
YELLOW = \033[1;33m
RED = \033[0;31m
NC = \033[0m

.PHONY: all clean compile-test help env-check

all: compile-test

help:
	@echo -e "$(BLUE)PulseOne í†µí•© ì•„í‚¤í…ì²˜ í…ŒìŠ¤íŠ¸$(NC)"
	@echo -e "$(GREEN)ëª…ë ¹ì–´:$(NC)"
	@echo -e "  make -f Makefile.unified.test compile-test"
	@echo -e "  make -f Makefile.unified.test env-check"
	@echo -e "  make -f Makefile.unified.test clean"

env-check:
	@echo -e "$(BLUE)í™˜ê²½ ê²€ì‚¬$(NC)"
	@g++ --version | head -1
	@echo -e "$(GREEN)C++17 í…ŒìŠ¤íŠ¸:$(NC)"
	@echo 'int main(){return 0;}' | g++ -std=c++17 -x c++ - -o /tmp/test 2>/dev/null && echo -e "$(GREEN)âœ… C++17 OK$(NC)" || echo -e "$(RED)âŒ C++17 ì˜¤ë¥˜$(NC)"
	@rm -f /tmp/test

compile-test: test_simple.cpp
	@echo -e "$(BLUE)ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸$(NC)"
	$(CXX) $(CXXFLAGS) -o test_simple test_simple.cpp
	@echo -e "$(GREEN)âœ… ì»´íŒŒì¼ ì„±ê³µ$(NC)"
	./test_simple
	@echo -e "$(GREEN)âœ… ì‹¤í–‰ ì„±ê³µ$(NC)"

test_simple.cpp:
	@echo -e "$(BLUE)í…ŒìŠ¤íŠ¸ íŒŒì¼ ìƒì„±$(NC)"
	@cat > test_simple.cpp << 'TESTEOF'
#include <iostream>
#include <string>
#include <vector>
#include <memory>

int main() {
    std::cout << "=== PulseOne ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ===" << std::endl;
    
    std::string device_name = "Test Device";
    std::vector<int> data_points = {1, 2, 3, 4, 5};
    auto smart_ptr = std::make_unique<std::string>("Smart Pointer Test");
    
    std::cout << "âœ… ë””ë°”ì´ìŠ¤: " << device_name << std::endl;
    std::cout << "âœ… ë°ì´í„° í¬ì¸íŠ¸: " << data_points.size() << "ê°œ" << std::endl;
    std::cout << "âœ… ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°: " << *smart_ptr << std::endl;
    std::cout << "ðŸŽŠ ëª¨ë“  ê¸°ë³¸ í…ŒìŠ¤íŠ¸ í†µê³¼!" << std::endl;
    
    return 0;
}
TESTEOF

clean:
	@echo -e "$(YELLOW)ì •ë¦¬ ì¤‘...$(NC)"
	@rm -f test_simple test_simple.cpp
	@echo -e "$(GREEN)âœ… ì •ë¦¬ ì™„ë£Œ$(NC)"
