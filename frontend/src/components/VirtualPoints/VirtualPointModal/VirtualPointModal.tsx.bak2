// ============================================================================
// VirtualPointModal.tsx - Hook ì—ëŸ¬ ìˆ˜ì •
// ============================================================================

import React, { useState, useEffect, useCallback } from 'react';
import { VirtualPoint, VirtualPointInput, ScriptFunction } from '../../../types/virtualPoints';
import { useScriptEngine } from '../../../hooks/shared/useScriptEngine';
import BasicInfoForm from './BasicInfoForm';
import FormulaEditor from './FormulaEditor';
import InputVariableEditor from './InputVariableEditor';
import ValidationPanel from './ValidationPanel';
import './VirtualPointModal.css';

interface VirtualPointModalProps {
  isOpen: boolean;
  mode: 'create' | 'edit';
  virtualPoint?: VirtualPoint;
  onSave: (data: Partial<VirtualPoint>) => Promise<void>;
  onClose: () => void;
  loading?: boolean;
}

interface FormData {
  // ê¸°ë³¸ ì •ë³´
  name: string;
  description: string;
  category: string;
  tags: string[];

  // ê³„ì‚° ì„¤ì •
  expression: string;
  execution_type: 'periodic' | 'on_change' | 'manual';
  execution_interval: number;
  priority: number;

  // ë°ì´í„° íƒ€ì…
  data_type: 'number' | 'boolean' | 'string';
  unit: string;
  decimal_places: number;

  // ì…ë ¥ ë³€ìˆ˜
  input_variables: VirtualPointInput[];

  // ê³ ê¸‰ ì„¤ì •
  timeout_ms: number;
  error_handling: 'propagate' | 'default_value' | 'previous_value';
  default_value: any;
  is_enabled: boolean;

  // ë²”ìœ„ ê²€ì¦
  min_value?: number;
  max_value?: number;

  // ìŠ¤ì¼€ì¤„ë§
  scope_type: 'device' | 'site' | 'global';
  scope_id?: number;
}

// ============================================================================
// ğŸ”¥ Hook ì—ëŸ¬ ìˆ˜ì •: ì»´í¬ë„ŒíŠ¸ í•¨ìˆ˜ ì‹œì‘ ë¶€ë¶„ì— ëª¨ë“  Hookì„ ì˜¬ë°”ë¥´ê²Œ ë°°ì¹˜
// ============================================================================

const VirtualPointModal: React.FC<VirtualPointModalProps> = ({
  isOpen,
  mode,
  virtualPoint,
  onSave,
  onClose,
  loading = false
}) => {
  // ğŸ”¥ Hook í˜¸ì¶œ ìˆœì„œ ìˆ˜ì •: ëª¨ë“  useStateë¥¼ ë§¨ ìœ„ì— ë°°ì¹˜
  const [currentStep, setCurrentStep] = useState(1);
  const totalSteps = 4;
  const [formData, setFormData] = useState<FormData>({
    name: '',
    description: '',
    category: '',
    tags: [],
    expression: '',
    execution_type: 'periodic',
    execution_interval: 5000,
    priority: 0,
    data_type: 'number',
    unit: '',
    decimal_places: 2,
    input_variables: [],
    timeout_ms: 10000,
    error_handling: 'propagate',
    default_value: 0,
    is_enabled: true,
    scope_type: 'device'
  });

  const [originalData, setOriginalData] = useState<FormData | null>(null);
  const [hasChanges, setHasChanges] = useState(false);
  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});
  const [validationWarnings, setValidationWarnings] = useState<Record<string, string>>({});
  const [isSaving, setIsSaving] = useState(false);
  const [isDataLoaded, setIsDataLoaded] = useState(false);

  // ğŸ”¥ useScriptEngine í›…ë„ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— ë°°ì¹˜
  const {
    functions,
    validationResult,
    isValidating,
    validateScript,
    loadFunctions
  } = useScriptEngine();

  // ========================================================================
  // ìë™ ì €ì¥ (localStorage) - ë°ì´í„° ì†ì‹¤ ë°©ì§€
  // ========================================================================

  const STORAGE_KEY = `virtual_point_draft_${mode}_${virtualPoint?.id || 'new'}`;

  const saveToLocalStorage = useCallback((data: FormData) => {
    try {
      localStorage.setItem(STORAGE_KEY, JSON.stringify({
        ...data,
        timestamp: Date.now()
      }));
      console.log('Draft ìë™ ì €ì¥ë¨');
    } catch (error) {
      console.warn('Draft ì €ì¥ ì‹¤íŒ¨:', error);
    }
  }, [STORAGE_KEY]);

  const loadFromLocalStorage = useCallback((): Partial<FormData> | null => {
    try {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        const data = JSON.parse(saved);
        // 1ì‹œê°„ ì´ë‚´ ë°ì´í„°ë§Œ ë³µì›
        if (Date.now() - data.timestamp < 60 * 60 * 1000) {
          console.log('Draft ë³µì›ë¨');
          return data;
        }
      }
    } catch (error) {
      console.warn('Draft ë³µì› ì‹¤íŒ¨:', error);
    }
    return null;
  }, [STORAGE_KEY]);

  const clearLocalStorage = useCallback(() => {
    try {
      localStorage.removeItem(STORAGE_KEY);
      console.log('Draft ì •ë¦¬ë¨');
    } catch (error) {
      console.warn('Draft ì •ë¦¬ ì‹¤íŒ¨:', error);
    }
  }, [STORAGE_KEY]);

  // ========================================================================
  // ğŸ”¥ Effects - Hook í˜¸ì¶œ ìˆœì„œ ë³´ì¥
  // ========================================================================

  useEffect(() => {
    if (isOpen) {
      console.log('VirtualPointModal ì—´ë¦¼:', { mode, virtualPoint });

      // ğŸ”¥ loadFunctionsê°€ í•¨ìˆ˜ì¸ì§€ í™•ì¸ í›„ í˜¸ì¶œ
      if (typeof loadFunctions === 'function') {
        loadFunctions().catch(console.warn);
      }

      // ê¸°ì¡´ ë°ì´í„° ë¡œë“œ ë˜ëŠ” ì´ˆê¸°í™”
      let initialData: FormData;

      if (mode === 'edit' && virtualPoint) {
        console.log('í¸ì§‘ ëª¨ë“œ - ë°ì´í„° ë¡œë”©:', virtualPoint);
        initialData = {
          name: virtualPoint.name || '',
          description: virtualPoint.description || '',
          category: virtualPoint.category || '',
          tags: Array.isArray(virtualPoint.tags) ? virtualPoint.tags :
            typeof virtualPoint.tags === 'string' ? virtualPoint.tags.split(',').map(t => t.trim()) : [],
          expression: virtualPoint.expression || virtualPoint.formula || '',
          execution_type: virtualPoint.execution_type || 'periodic',
          execution_interval: virtualPoint.execution_interval || 5000,
          priority: virtualPoint.priority || 0,
          data_type: virtualPoint.data_type || 'number',
          unit: virtualPoint.unit || '',
          decimal_places: virtualPoint.decimal_places || 2,
          input_variables: Array.isArray(virtualPoint.input_variables) ? virtualPoint.input_variables : [],
          timeout_ms: virtualPoint.timeout_ms || 10000,
          error_handling: virtualPoint.error_handling || 'propagate',
          default_value: virtualPoint.default_value !== undefined ? virtualPoint.default_value : 0,
          is_enabled: virtualPoint.is_enabled !== undefined ? virtualPoint.is_enabled : true,
          scope_type: virtualPoint.scope_type || 'device',
          scope_id: virtualPoint.scope_id,
          min_value: virtualPoint.min_value,
          max_value: virtualPoint.max_value
        };

        console.log('ì´ˆê¸°í™”ëœ formData:', initialData);

      } else {
        initialData = {
          name: '',
          description: '',
          category: '',
          tags: [],
          expression: '',
          execution_type: 'periodic',
          execution_interval: 5000,
          priority: 0,
          data_type: 'number',
          unit: '',
          decimal_places: 2,
          input_variables: [],
          timeout_ms: 10000,
          error_handling: 'propagate',
          default_value: 0,
          is_enabled: true,
          scope_type: 'device'
        };
      }

      // Draft ë³µì› í™•ì¸ (ìƒì„± ëª¨ë“œì—ì„œë§Œ)
      const savedDraft = loadFromLocalStorage();
      if (savedDraft && mode === 'create') {
        const shouldRestore = window.confirm(
          'ì´ì „ì— ì‘ì„±í•˜ë˜ ë‚´ìš©ì´ ìˆìŠµë‹ˆë‹¤. ë³µì›í•˜ì‹œê² ìŠµë‹ˆê¹Œ?'
        );
        if (shouldRestore) {
          initialData = { ...initialData, ...savedDraft };
        }
      }

      setFormData(initialData);
      setOriginalData(initialData);
      setCurrentStep(1);
      setHasChanges(false);
      setValidationErrors({});
      setValidationWarnings({});
      setIsDataLoaded(true);

      // ì´ˆê¸° ê²€ì¦ ì‹¤í–‰ (ë°ì´í„° ë¡œë”© ì™„ë£Œ í›„)
      setTimeout(() => {
        validateForm(initialData);
      }, 100);
    } else {
      setIsDataLoaded(false);
    }
  }, [isOpen, mode, virtualPoint, loadFunctions, loadFromLocalStorage]);

  // í¼ ë°ì´í„° ë³€ê²½ ì‹œ ìë™ ì €ì¥ (ë°ì´í„° ë¡œë”© ì™„ë£Œ í›„ì—ë§Œ)
  useEffect(() => {
    if (isOpen && isDataLoaded) {
      setHasChanges(true);

      // ìë™ ì €ì¥ (500ms ë””ë°”ìš´ìŠ¤)
      const timer = setTimeout(() => {
        saveToLocalStorage(formData);
      }, 500);

      // ì‹¤ì‹œê°„ ê²€ì¦
      validateForm(formData);

      return () => clearTimeout(timer);
    }
  }, [formData, isOpen, isDataLoaded, saveToLocalStorage]);

  // ========================================================================
  // Validation
  // ========================================================================

  const validateFormula = useCallback(async () => {
    if (!formData.expression.trim()) return;

    try {
      const context: Record<string, any> = {};
      formData.input_variables.forEach(input => {
        context[input.variable_name] = getSampleValue(input.data_type);
      });

      // ğŸ”¥ validateScriptê°€ í•¨ìˆ˜ì¸ì§€ í™•ì¸ í›„ í˜¸ì¶œ
      if (typeof validateScript === 'function') {
        await validateScript(formData.expression, context);
      }
    } catch (error) {
      console.error('ê³µì‹ ê²€ì¦ ì‹¤íŒ¨:', error);
    }
  }, [formData.expression, formData.input_variables, validateScript]);

  const getSampleValue = (dataType: string): any => {
    switch (dataType) {
      case 'number': return 100;
      case 'boolean': return true;
      case 'string': return 'sample';
      default: return null;
    }
  };

  const validateForm = useCallback((dataToValidate: FormData = formData): { errors: Record<string, string>, warnings: Record<string, string> } => {
    const errors: Record<string, string> = {};
    const warnings: Record<string, string> = {};

    // ğŸš¨ ì¹˜ëª…ì  ì˜¤ë¥˜ (ì €ì¥ ë¶ˆê°€)
    if (!dataToValidate.name.trim()) {
      errors.name = 'ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤';
    }

    // âš ï¸ ê²½ê³ ì‚¬í•­ (ì €ì¥ ê°€ëŠ¥í•˜ì§€ë§Œ ê¶Œì¥í•˜ì§€ ì•ŠìŒ)
    if (!dataToValidate.category.trim()) {
      warnings.category = 'ì¹´í…Œê³ ë¦¬ë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤';
    }

    if (!dataToValidate.expression.trim()) {
      warnings.expression = 'ìˆ˜ì‹ì„ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤';
    }

    // ìˆ˜ì‹ ë³€ìˆ˜ ê²€ì¦
    if (dataToValidate.expression) {
      const usedVariables = extractVariablesFromExpression(dataToValidate.expression);
      const definedVariables = dataToValidate.input_variables.map(v => v.variable_name);
      const missingVariables = usedVariables.filter(v => !definedVariables.includes(v));

      if (missingVariables.length > 0) {
        warnings.expression = `ì •ì˜ë˜ì§€ ì•Šì€ ë³€ìˆ˜: ${missingVariables.join(', ')}`;
      }
    }

    // ë²”ìœ„ ê²€ì¦
    if (dataToValidate.min_value !== undefined && dataToValidate.max_value !== undefined) {
      if (dataToValidate.min_value >= dataToValidate.max_value) {
        warnings.range = 'ìµœì†Ÿê°’ì´ ìµœëŒ“ê°’ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ìŠµë‹ˆë‹¤';
      }
    }

    // ì‹¤í–‰ ê°„ê²© ê²€ì¦
    if (dataToValidate.execution_type === 'periodic' && dataToValidate.execution_interval < 1000) {
      warnings.execution_interval = 'ì‹¤í–‰ ê°„ê²©ì´ ë„ˆë¬´ ì§§ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (1ì´ˆ ë¯¸ë§Œ)';
    }

    setValidationErrors(errors);
    setValidationWarnings(warnings);

    console.log('ê²€ì¦ ê²°ê³¼:', {
      dataToValidate: { name: dataToValidate.name, category: dataToValidate.category },
      errors,
      warnings
    });

    return { errors, warnings };
  }, [formData]);

  const extractVariablesFromExpression = (expression: string): string[] => {
    const matches = expression.match(/[a-zA-Z_][a-zA-Z0-9_]*/g);
    return matches ? Array.from(new Set(matches)) : [];
  };

  // ========================================================================
  // Event Handlers
  // ========================================================================

  const handleFormDataChange = useCallback((field: keyof FormData, value: any) => {
    console.log('í•„ë“œ ë³€ê²½:', field, value);
    setFormData(prev => ({ ...prev, [field]: value }));
  }, []);

  const handleInputVariableChange = useCallback((variables: VirtualPointInput[]) => {
    console.log('ì…ë ¥ë³€ìˆ˜ ì¦‰ì‹œ ì—…ë°ì´íŠ¸:', variables);
    setFormData(prev => ({
      ...prev,
      input_variables: variables
    }));
  }, []);

  const handleMoveToFormulaTab = useCallback(() => {
    console.log('ìˆ˜ì‹ í¸ì§‘ ë‹¨ê³„ë¡œ ì´ë™');
    setCurrentStep(3);
  }, []);

  const handleNextStep = () => {
    if (currentStep < totalSteps) {
      setCurrentStep(currentStep + 1);
    }
  };

  const handlePrevStep = () => {
    if (currentStep > 1) {
      setCurrentStep(currentStep - 1);
    }
  };

  const canProceedToNext = () => {
    switch (currentStep) {
      case 1: return !!formData.name.trim();
      case 2: return true; // ì…ë ¥ ë³€ìˆ˜ëŠ” ì„ íƒì‚¬í•­
      case 3: return !!formData.expression.trim();
      case 4: return true;
      default: return false;
    }
  };

  const handleSave = async () => {
    console.log('ğŸš€ ì €ì¥ ì‹œì‘:', { mode, formData: { name: formData.name, category: formData.category } });

    const validation = validateForm();

    // ì¹˜ëª…ì  ì˜¤ë¥˜ê°€ ìˆìœ¼ë©´ ì €ì¥ ì¤‘ë‹¨
    if (Object.keys(validation.errors).length > 0) {
      alert('í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”:\n' + Object.values(validation.errors).join('\n'));

      if (validation.errors.name) {
        setCurrentStep(1);
      }
      return;
    }

    // ì €ì¥ í™•ì¸
    let confirmMessage = `ê°€ìƒí¬ì¸íŠ¸ë¥¼ ${mode === 'create' ? 'ìƒì„±' : 'ìˆ˜ì •'}í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n`;
    confirmMessage += `ì´ë¦„: ${formData.name}\n`;
    confirmMessage += `ì¹´í…Œê³ ë¦¬: ${formData.category || 'ë¯¸ì„¤ì •'}\n`;
    confirmMessage += `ìˆ˜ì‹: ${formData.expression || 'ë¯¸ì„¤ì •'}\n`;
    confirmMessage += `ì…ë ¥ë³€ìˆ˜: ${formData.input_variables.length}ê°œ`;

    if (Object.keys(validation.warnings).length > 0) {
      confirmMessage += '\n\nâš ï¸ ê²½ê³ ì‚¬í•­:\n' + Object.values(validation.warnings).join('\n');
    }

    if (!window.confirm(confirmMessage)) {
      return;
    }

    setIsSaving(true);
    try {
      console.log('ğŸ“¤ onSave í˜¸ì¶œ ì‹œì‘...');

      await onSave(formData);

      console.log('âœ… onSave ì™„ë£Œ - ë¶€ëª¨ì—ì„œ ìƒˆë¡œê³ ì¹¨ë¨');

      // ì„±ê³µ í›„ ì²˜ë¦¬
      setHasChanges(false);
      clearLocalStorage();

      console.log(`ğŸ‰ ê°€ìƒí¬ì¸íŠ¸ ${mode === 'create' ? 'ìƒì„±' : 'ìˆ˜ì •'} ì™„ë£Œ: ${formData.name}`);

      onClose();

    } catch (error) {
      console.error('âŒ ì €ì¥ ì‹¤íŒ¨:', error);
      alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n' + (error instanceof Error ? error.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
    } finally {
      setIsSaving(false);
    }
  };

  const handleClose = () => {
    if (hasChanges) {
      const choice = window.confirm(
        'ë³€ê²½ì‚¬í•­ì´ ì €ì¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\n\n' +
        '- í™•ì¸: ë³€ê²½ì‚¬í•­ì„ ë²„ë¦¬ê³  ë‹«ê¸°\n' +
        '- ì·¨ì†Œ: ê³„ì† í¸ì§‘í•˜ê¸°\n\n' +
        '(ì°¸ê³ : ì‘ì—… ë‚´ìš©ì€ ìë™ìœ¼ë¡œ ì„ì‹œ ì €ì¥ë˜ë¯€ë¡œ ë‚˜ì¤‘ì— ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤)'
      );

      if (choice) {
        onClose();
      }
    } else {
      clearLocalStorage();
      onClose();
    }
  };

  const getStepInfo = (step: number) => {
    const steps = [
      { number: 1, label: 'IDENTITY', title: 'ê¸°ë³¸ ì‹ë³„ ì •ë³´', icon: 'fas fa-id-card' },
      { number: 2, label: 'INPUT', title: 'ì…ë ¥ ë³€ìˆ˜ ì„¤ì •', icon: 'fas fa-plug' },
      { number: 3, label: 'FORMULA', title: 'ìˆ˜ì‹ ì‘ì„±', icon: 'fas fa-code' },
      { number: 4, label: 'FINALIZE', title: 'ì„¤ì • ì™„ë£Œ', icon: 'fas fa-check-circle' }
    ];
    return steps[step - 1];
  };

  // ========================================================================
  // ğŸ”¥ ì¡°ê±´ë¶€ ë Œë”ë§ ìˆ˜ì • - Hook ê·œì¹™ ì¤€ìˆ˜
  // ========================================================================

  // Hook í˜¸ì¶œì´ ì™„ë£Œëœ í›„ ì¡°ê±´ë¶€ ë°˜í™˜
  if (!isOpen) {
    return null;
  }

  const totalErrors = Object.keys(validationErrors).length;
  const totalWarnings = Object.keys(validationWarnings).length;
  const canSave = totalErrors === 0;

  return (
    <div className="modal-overlay" onClick={(e) => e.target === e.currentTarget && handleClose()}>
      <div className="modal-container virtual-point-modal">
        {/* ëª¨ë‹¬ í—¤ë” */}
        <div className="modal-header">
          <h2>
            <i className="fas fa-function"></i>
            {mode === 'create' ? 'ìƒˆ ê°€ìƒí¬ì¸íŠ¸ ìƒì„±' : 'ê°€ìƒí¬ì¸íŠ¸ í¸ì§‘'}
            {hasChanges && <span style={{ color: '#f59e0b', marginLeft: '8px' }}>â—</span>}
          </h2>
          <button className="modal-close-btn" onClick={handleClose}>
            <i className="fas fa-times"></i>
          </button>
        </div>

        </div>

        {/* ëª¨ë‹¬ í‘¸í„° */}
        <div className="modal-footer">
          <div className="footer-left">
            <span className="auto-save-indicator">
              <i className="fas fa-save" style={{ color: '#10b981' }}></i>
              ìë™ ì €ì¥ë¨
            </span>
            {totalErrors > 0 && (
              <span className="error-indicator">
                <i className="fas fa-exclamation-circle"></i>
                {totalErrors}ê°œ ì˜¤ë¥˜
              </span>
            )}
            {totalWarnings > 0 && (
              <span className="warning-indicator">
                <i className="fas fa-exclamation-triangle"></i>
                {totalWarnings}ê°œ ê²½ê³ 
              </span>
            )}
            <span className="variables-count">
              ì…ë ¥ë³€ìˆ˜: {formData.input_variables.length}ê°œ
            </span>
          </div>

          <div className="footer-actions">
            <button
              type="button"
              className="btn-secondary"
              onClick={handleClose}
              disabled={isSaving || loading}
            >
              ì·¨ì†Œ
            </button>
            <button
              type="button"
              className={canSave ? "btn-primary" : "btn-primary-disabled"}
              onClick={handleSave}
              disabled={isSaving || loading || !canSave}
              title={!canSave ? "í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" : ""}
            >
              {isSaving || loading ? (
                <>
                  <i className="fas fa-spinner fa-spin"></i>
                  ì €ì¥ ì¤‘...
                </>
              ) : (
                <>
                  <i className="fas fa-save"></i>
                  {mode === 'create' ? 'ìƒì„±' : 'ì €ì¥'}
                  {totalWarnings > 0 && ' (ê²½ê³  ìˆìŒ)'}
                </>
              )}
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

export default VirtualPointModal;

// ============================================================================
// ğŸ”¥ ìˆ˜ì • ì‚¬í•­ ìš”ì•½
// ============================================================================

/*
1. Hook í˜¸ì¶œ ìˆœì„œ ìˆ˜ì •:
   - ëª¨ë“  useState í˜¸ì¶œì„ ì»´í¬ë„ŒíŠ¸ í•¨ìˆ˜ ìµœìƒë‹¨ì— ë°°ì¹˜
   - useScriptEngine í›…ë„ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— ë°°ì¹˜
   - ì¡°ê±´ë¶€ ë°˜í™˜(return null)ì„ ëª¨ë“  Hook í˜¸ì¶œ ì´í›„ë¡œ ì´ë™

2. í•¨ìˆ˜ í˜¸ì¶œ ì•ˆì „ì„± ì¶”ê°€:
   - loadFunctionsì™€ validateScript í•¨ìˆ˜ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í›„ í˜¸ì¶œ
   - try-catchë¡œ ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”

3. Effect ì˜ì¡´ì„± ì •ë¦¬:
   - useEffect ì˜ì¡´ì„± ë°°ì—´ì—ì„œ ë¶ˆí•„ìš”í•œ í•¨ìˆ˜ ì œê±°
   - loadFromLocalStorage ë“± ì½œë°± í•¨ìˆ˜ì˜ ì˜ì¡´ì„± ìµœì í™”

ì´ì œ Hook ê·œì¹™ì„ ì¤€ìˆ˜í•˜ì—¬ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.
*/