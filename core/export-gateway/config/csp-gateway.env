# =============================================================================
# CSP Gateway 메인 설정 파일 (csp-gateway.env)
# =============================================================================

# =============================================================================
# CSP Gateway 기본 설정
# =============================================================================
CSP_GATEWAY_ENABLED=true
CSP_GATEWAY_SERVICE_NAME=PulseOne CSP Gateway
CSP_GATEWAY_VERSION=1.8
CSP_GATEWAY_BUILDING_ID=1001

# 서비스 모드 설정
CSP_GATEWAY_DEBUG_MODE=true
CSP_GATEWAY_MAINTENANCE_MODE=false
CSP_GATEWAY_MAX_WORKER_THREADS=4
CSP_GATEWAY_QUEUE_MAX_SIZE=10000

# =============================================================================
# 전송 대상 설정 파일 경로
# =============================================================================
CSP_TARGETS_CONFIG_FILE=${CONFIG_DIR}/csp-targets.json

# =============================================================================
# 멀티빌딩 지원 설정
# =============================================================================
CSP_MULTI_BUILDING_ENABLED=true
CSP_SUPPORTED_BUILDING_IDS=1001,1002,1003,1004
CSP_BUILDING_DELIMITER=.

# =============================================================================
# 알람 필터링 설정
# =============================================================================
# 알람 무시 시간 (분) - C# ignoreTime 로직
CSP_ALARM_IGNORE_MINUTES=5
CSP_USE_LOCAL_TIME=true
CSP_ALARM_TIME_FORMAT=csharp_datetime

# 알람 우선순위 필터 (1=Critical, 2=High, 3=Medium, 4=Low, 5=Info)
CSP_ALARM_MIN_PRIORITY=1
CSP_ALARM_MAX_PRIORITY=4

# 태그 필터 패턴 (정규식)
CSP_ALARM_TAG_INCLUDE_PATTERN=.*
CSP_ALARM_TAG_EXCLUDE_PATTERN=^TEST_.*

# 시간 필터 (오래된 알람 무시)
CSP_ALARM_MAX_AGE_HOURS=24

# =============================================================================
# 배치 처리 및 파일 관리 설정
# =============================================================================
CSP_BATCH_PROCESSING_ENABLED=true
CSP_BATCH_SIZE=100
CSP_BATCH_TIMEOUT_MS=5000
CSP_BATCH_FLUSH_INTERVAL_MS=10000

# 파일 저장 경로 설정
CSP_ALARM_DIR_PATH=${DATA_DIR}/alarm_files
CSP_FAILED_FILE_PATH=${DATA_DIR}/failed_alarms

# 자동 정리 설정 (C# File.Delete 로직)
CSP_AUTO_CLEANUP_SUCCESS_FILES=true
CSP_KEEP_FAILED_FILES_DAYS=7
CSP_CLEANUP_INTERVAL_HOURS=24

# 배치 파일 명명 규칙
CSP_BATCH_FILE_PATTERN={building_id}_{timestamp}_batch.json
CSP_FAILED_FILE_PATTERN=failed_{timestamp}_{building_id}_{nm}.json

# =============================================================================
# 데이터 처리 설정
# =============================================================================
# Modbus 태그 관련 (기존 C# 버전 이슈 수정 사항 적용)
CSP_MODBUS_ALARM_TIMEZONE=LOCAL_TIME
CSP_MODBUS_UPDATE_TIME_SOURCE=DATA_TIME
CSP_MODBUS_INVALID_VALUE_THRESHOLD=-2147483638
CSP_MODBUS_USE_PREVIOUS_ON_INVALID=true

# 알람 처리 시간 설정
CSP_UPDATE_TIME_OPTION=SCADA_TIME

# =============================================================================
# 로그 및 모니터링 설정
# =============================================================================
CSP_DETAILED_LOGGING=true
CSP_LOG_VALUE_FILE_SAVE=true
CSP_LOG_UPDATE_TIME_ERROR=true
CSP_LOG_NETWORK_RECONNECT=true

# 성능 모니터링
CSP_PERFORMANCE_MONITORING=true
CSP_STATS_UPDATE_INTERVAL_MS=30000
CSP_HEALTH_CHECK_INTERVAL_MS=60000

# =============================================================================
# 실패 처리 설정
# =============================================================================
# 실패한 알람 파일 저장
CSP_FAILED_ALARM_SAVE_ENABLED=true
CSP_FAILED_ALARM_RETRY_ENABLED=true
CSP_FAILED_ALARM_RETRY_INTERVAL_MINUTES=30
CSP_FAILED_ALARM_MAX_RETRY_COUNT=5

# =============================================================================
# 스케줄 설정
# =============================================================================
CSP_SCHEDULE_ENABLED=true
CSP_SCHEDULE_HOURLY_AT_ZERO=true
CSP_SCHEDULE_MISSED_EXECUTION_HANDLING=EXECUTE_IMMEDIATELY

# =============================================================================
# 네트워크 설정
# =============================================================================
CSP_NETWORK_RECONNECT_ENABLED=true
CSP_NETWORK_RECONNECT_TIMEOUT_MS=30000
CSP_NETWORK_SERVICE_RESTART_ON_RECONNECT=true

# =============================================================================
# 보안 설정
# =============================================================================
CSP_SSL_ENABLED=true
CSP_SSL_VERIFY_PEER=true
CSP_SSL_CERT_FILE=${SECRETS_DIR}/csp_client.crt
CSP_SSL_KEY_FILE=${SECRETS_DIR}/csp_client.key
CSP_SSL_CA_FILE=${SECRETS_DIR}/csp_ca.crt

# =============================================================================
# 호환성 설정
# =============================================================================
# 기존 HDC CSP Gateway 호환 모드
CSP_HDC_COMPATIBILITY_MODE=false
CSP_HDC_LEGACY_TIME_FORMAT=false

# Cloud Gateway 별칭 지원
CSP_CLOUD_GATEWAY_MODE=true
CSP_SERVICE_TITLE=Cloud Gateway

# =============================================================================
# Dynamic Targets 설정
# =============================================================================
CSP_USE_DYNAMIC_TARGETS=true
CSP_DYNAMIC_TARGETS_CONFIG=/app/config/csp-targets.json