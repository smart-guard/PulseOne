# =============================================================================
# ğŸ¯ ì´ê²ƒì´ Makefile ì™„ì„±ë³¸ì…ë‹ˆë‹¤!
# core/export-gateway/Makefile - PulseOne Export Gateway (í¬ë¡œìŠ¤í”Œë«í¼)
# ğŸ”¥ HAS_SHARED_LIBS ë§¤í¬ë¡œ ì •ì˜ ë³´ê°• ì™„ë£Œ
# =============================================================================

# í”Œë«í¼ ê°ì§€ (shared Makefileê³¼ ë™ì¼í•œ ë¡œì§)
UNAME := $(shell uname -s 2>/dev/null || echo Windows)
ifeq ($(UNAME),Linux)
    PLATFORM := Linux
    IS_WINDOWS := 0
else ifeq ($(OS),Windows_NT)
    PLATFORM := Windows
    IS_WINDOWS := 1
else
    PLATFORM := $(UNAME)
    IS_WINDOWS := 0
endif

# ì»´íŒŒì¼ëŸ¬ ì„¤ì •
CXX = g++
CC = gcc

# ê¸°ë³¸ ì»´íŒŒì¼ í”Œë˜ê·¸
CXXFLAGS = -std=c++17 -Wall -Wextra -O2 -fPIC
CFLAGS = -std=c11 -Wall -Wextra -O2 -fPIC

# Windows í¬ë¡œìŠ¤ ì»´íŒŒì¼ ì§€ì› (sharedì™€ ë™ì¼)
ifeq ($(CROSS_COMPILE_WINDOWS),1)
    CXX = x86_64-w64-mingw32-g++
    CC = x86_64-w64-mingw32-gcc
    CXXFLAGS += -DWIN32 -D_WIN32_WINNT=0x0601 -DWIN32_LEAN_AND_MEAN -DNOMINMAX
    CFLAGS += -DWIN32 -D_WIN32_WINNT=0x0601 -DWIN32_LEAN_AND_MEAN -DNOMINMAX
    PLATFORM := Windows-Cross
    MINGW_PREFIX = /usr/x86_64-w64-mingw32
    INCLUDES += -I$(MINGW_PREFIX)/include
    EXE_SUFFIX = .exe
    LIB_SUFFIX = .a
else ifeq ($(IS_WINDOWS),1)
    CXXFLAGS += -DPULSEONE_WINDOWS=1
    CFLAGS += -DPULSEONE_WINDOWS=1
    EXE_SUFFIX = .exe
    LIB_SUFFIX = .a
else
    CXXFLAGS += -DPULSEONE_LINUX=1
    CFLAGS += -DPULSEONE_LINUX=1
    EXE_SUFFIX =
    LIB_SUFFIX = .a
endif

# ë””ë²„ê·¸/ë¦´ë¦¬ì¦ˆ í”Œë˜ê·¸ (DEBUG ë§¤í¬ë¡œ ì¶©ëŒ ë°©ì§€)
ifeq ($(BUILD_TYPE),Debug)
    CXXFLAGS += -g -O0 -fno-omit-frame-pointer
    # DEBUG ë§¤í¬ë¡œ ì¶©ëŒ ë°©ì§€: PULSEONE_DEBUG ì‚¬ìš©
    CXXFLAGS += -DPULSEONE_DEBUG=1
else
    CXXFLAGS += -DNDEBUG -O2
    CXXFLAGS += -DPULSEONE_DEBUG=0
endif

# =============================================================================
# ë””ë ‰í† ë¦¬ êµ¬ì¡° (shared-checkë³´ë‹¤ ë¨¼ì € ì •ì˜)
# =============================================================================

# í˜„ì¬ ë””ë ‰í† ë¦¬
EXPORT_GATEWAY_DIR = $(shell pwd)
PROJECT_ROOT = $(shell dirname $(shell dirname $(EXPORT_GATEWAY_DIR)))
SHARED_DIR = $(PROJECT_ROOT)/core/shared

# ì†ŒìŠ¤ ë””ë ‰í† ë¦¬
SRC_DIR = src
INCLUDE_DIR = include
BUILD_DIR = build
BIN_DIR = bin

# Shared ë¼ì´ë¸ŒëŸ¬ë¦¬ ë””ë ‰í† ë¦¬
SHARED_INCLUDE_DIR = $(SHARED_DIR)/include
SHARED_LIB_DIR = $(SHARED_DIR)/lib

# =============================================================================
# ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°ì§€ ë° ì„¤ì • (collector íŒ¨í„´) ğŸ”¥ ë³´ê°• ì™„ë£Œ
# =============================================================================

# ğŸ”¥ Shared ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¡´ì¬ ì—¬ë¶€ ì •ë°€ ê°ì§€ (collectorì™€ 100% ë™ì¼ íŒ¨í„´)
HAS_SHARED := $(shell [ -d "$(SHARED_LIB_DIR)" ] && [ -f "$(SHARED_LIB_DIR)/libpulseone-common$(LIB_SUFFIX)" ] && echo "1" || echo "0")

# ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°ì§€ (collectorì™€ ë™ì¼)
HAS_NLOHMANN_JSON := $(shell echo '\#include <nlohmann/json.hpp>' | $(CXX) -E -x c++ - >/dev/null 2>&1 && echo "1" || echo "0")
HAS_HIREDIS := $(shell echo '\#include <hiredis/hiredis.h>' | $(CXX) -E -x c++ - >/dev/null 2>&1 && echo "1" || echo "0")
HAS_HTTPLIB := $(shell echo '\#include <httplib.h>' | $(CXX) -E -x c++ - >/dev/null 2>&1 && echo "1" || echo "0")

# =============================================================================
# Include ê²½ë¡œë“¤ (collector íŒ¨í„´ ì ìš©)
# =============================================================================

# ê¸°ë³¸ Include ê²½ë¡œ
INCLUDES = -I$(INCLUDE_DIR)

# ğŸ”¥ Shared ë¼ì´ë¸ŒëŸ¬ë¦¬ Include (collectorì™€ ë™ì¼ íŒ¨í„´)
ifeq ($(HAS_SHARED),1)
    # Shared ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìš°ì„ ìˆœìœ„ë¡œ ì„¤ì •
    INCLUDES := -I$(SHARED_INCLUDE_DIR) $(INCLUDES)
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Platform
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Common
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Utils
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Database
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Database/Entities
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Database/Repositories
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Alarm
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Export
    INCLUDES += -I$(SHARED_INCLUDE_DIR)/Client
endif

# ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ Include
INCLUDES += -I/usr/local/include

# Windows í¬ë¡œìŠ¤ ì»´íŒŒì¼ìš© Include
ifeq ($(CROSS_COMPILE_WINDOWS),1)
    INCLUDES += -I$(MINGW_PREFIX)/include
endif

# =============================================================================
# ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§í¬ (collector íŒ¨í„´) ğŸ”¥ ì¤‘ìš”: HAS_SHARED_LIBS ë§¤í¬ë¡œ ì •ì˜
# =============================================================================

# Shared ë¼ì´ë¸ŒëŸ¬ë¦¬ (collectorì™€ ë™ì¼ ìˆœì„œ)
ifeq ($(HAS_SHARED),1)
    SHARED_LIBS = -L$(SHARED_LIB_DIR)
    SHARED_LIBS += -lpulseone-alarm
    SHARED_LIBS += -lpulseone-database  
    SHARED_LIBS += -lpulseone-client
    SHARED_LIBS += -lpulseone-export
    SHARED_LIBS += -lpulseone-common
    # ğŸ”¥ í•µì‹¬: HAS_SHARED_LIBS ë§¤í¬ë¡œ ì •ì˜ (LOG_INFO ë§¤í¬ë¡œë¥¼ ìœ„í•´)
    CXXFLAGS += -DHAS_SHARED_LIBS=1
    # ğŸ”¥ ì»´íŒŒì¼ íƒ€ì„ í™•ì¸ìš© ë©”ì‹œì§€
    $(info âœ… HAS_SHARED=1 detected - LogManager will be available)
else
    SHARED_LIBS =
    # ğŸ”¥ ë””ë²„ê¹…ìš© - shared ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì„ ë•Œ ì•Œë¦¼
    $(info âš ï¸  HAS_SHARED=0 - LogManager not available, logging disabled)
    $(info     Shared lib path: $(SHARED_LIB_DIR))
    $(info     Looking for: $(SHARED_LIB_DIR)/libpulseone-common$(LIB_SUFFIX))
endif

# ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤
UTILITY_LIBS =
ifeq ($(HAS_HIREDIS),1)
    UTILITY_LIBS += -lhiredis
    CXXFLAGS += -DHAVE_REDIS=1
endif

ifeq ($(HAS_HTTPLIB),1)
    CXXFLAGS += -DHAVE_HTTPLIB=1
endif

ifeq ($(HAS_NLOHMANN_JSON),1)
    CXXFLAGS += -DHAS_NLOHMANN_JSON=1
endif

# ê¸°ë³¸ ì‹œìŠ¤í…œ ë¼ì´ë¸ŒëŸ¬ë¦¬
ifeq ($(IS_WINDOWS),1)
    BASIC_LIBS = -lpthread -lstdc++ -lm
    PLATFORM_LIBS = -lws2_32 -lwsock32 -liphlpapi
else
    BASIC_LIBS = -lpthread -lm -ldl
    PLATFORM_LIBS =
endif

# ìµœì¢… ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§í‚¹ ìˆœì„œ (collectorì™€ ë™ì¼)
LDFLAGS += $(SHARED_LIBS) $(UTILITY_LIBS) $(BASIC_LIBS) $(PLATFORM_LIBS)

# ìƒ‰ìƒ ì •ì˜
GREEN = \033[0;32m
BLUE = \033[0;34m
YELLOW = \033[1;33m
RED = \033[0;31m
NC = \033[0m

# =============================================================================
# ì†ŒìŠ¤ íŒŒì¼ ë° ì˜¤ë¸Œì íŠ¸ íŒŒì¼
# =============================================================================

# CSP ê´€ë ¨ ì†ŒìŠ¤ë“¤
CSP_SOURCES = $(wildcard $(SRC_DIR)/CSP/*.cpp)
CSP_OBJECTS = $(CSP_SOURCES:$(SRC_DIR)/%.cpp=$(BUILD_DIR)/%.o)

# Export ê´€ë ¨ ì†ŒìŠ¤ë“¤ (í–¥í›„ í™•ì¥)
EXPORT_SOURCES = $(wildcard $(SRC_DIR)/Export/*.cpp)
EXPORT_OBJECTS = $(EXPORT_SOURCES:$(SRC_DIR)/%.cpp=$(BUILD_DIR)/%.o)

# ìœ í‹¸ë¦¬í‹° ì†ŒìŠ¤ë“¤
UTILS_SOURCES = $(wildcard $(SRC_DIR)/Utils/*.cpp)
UTILS_OBJECTS = $(UTILS_SOURCES:$(SRC_DIR)/%.cpp=$(BUILD_DIR)/%.o)

# ë©”ì¸ ì†ŒìŠ¤
MAIN_SOURCES = $(wildcard $(SRC_DIR)/*.cpp)
MAIN_OBJECTS = $(MAIN_SOURCES:$(SRC_DIR)/%.cpp=$(BUILD_DIR)/%.o)

# ì „ì²´ ì˜¤ë¸Œì íŠ¸ë“¤
ALL_OBJECTS = $(CSP_OBJECTS) $(EXPORT_OBJECTS) $(UTILS_OBJECTS) $(MAIN_OBJECTS)

# ì‹¤í–‰ íŒŒì¼ (í”Œë«í¼ë³„ í™•ì¥ì)
TARGET = $(BIN_DIR)/export-gateway$(EXE_SUFFIX)

# =============================================================================
# ë©”ì¸ íƒ€ê²Ÿë“¤
# =============================================================================

.PHONY: all clean debug release test install help shared-check debug-config

# ê¸°ë³¸ íƒ€ê²Ÿ
all: shared-check $(BUILD_DIR) $(BIN_DIR) $(TARGET)

# ë””ë²„ê·¸ ë¹Œë“œ
debug:
	@$(MAKE) BUILD_TYPE=Debug all

# ë¦´ë¦¬ì¦ˆ ë¹Œë“œ 
release:
	@$(MAKE) BUILD_TYPE=Release all

# =============================================================================
# ë””ë ‰í† ë¦¬ ìƒì„±
# =============================================================================

$(BUILD_DIR) $(BIN_DIR):
	@mkdir -p $@
	@mkdir -p $(BUILD_DIR)/CSP $(BUILD_DIR)/Export $(BUILD_DIR)/Utils

# =============================================================================
# Shared ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„± ì²´í¬ (collector íŒ¨í„´) ğŸ”¥ ë³´ê°•
# =============================================================================

shared-check:
	@echo -e "$(BLUE)ğŸ” Checking PulseOne Shared Libraries [$(PLATFORM)]...$(NC)"
	@echo "Shared lib directory: $(SHARED_LIB_DIR)"
	@echo "HAS_SHARED detection result: $(HAS_SHARED)"
	@if [ ! -d "$(SHARED_LIB_DIR)" ]; then \
		echo -e "$(RED)âŒ Shared library directory not found: $(SHARED_LIB_DIR)$(NC)"; \
		echo -e "$(YELLOW)ğŸ’¡ Please build shared libraries first:$(NC)"; \
		echo -e "$(YELLOW)   cd $(SHARED_DIR) && make all$(NC)"; \
		exit 1; \
	fi
	@echo -e "Shared libs:"
	@echo -e "  libpulseone-common: $(if $(wildcard $(SHARED_LIB_DIR)/libpulseone-common$(LIB_SUFFIX)),$(GREEN)âœ…$(NC),$(RED)âŒ$(NC))"
	@echo -e "  libpulseone-database: $(if $(wildcard $(SHARED_LIB_DIR)/libpulseone-database$(LIB_SUFFIX)),$(GREEN)âœ…$(NC),$(RED)âŒ$(NC))"
	@echo -e "  libpulseone-client: $(if $(wildcard $(SHARED_LIB_DIR)/libpulseone-client$(LIB_SUFFIX)),$(GREEN)âœ…$(NC),$(RED)âŒ$(NC))"
	@echo -e "  libpulseone-export: $(if $(wildcard $(SHARED_LIB_DIR)/libpulseone-export$(LIB_SUFFIX)),$(GREEN)âœ…$(NC),$(RED)âŒ$(NC))"
	@echo -e "  libpulseone-alarm: $(if $(wildcard $(SHARED_LIB_DIR)/libpulseone-alarm$(LIB_SUFFIX)),$(GREEN)âœ…$(NC),$(RED)âŒ$(NC))"
ifeq ($(HAS_SHARED),1)
	@echo -e "$(GREEN)âœ… HAS_SHARED_LIBS=1 - LogManager will be available$(NC)"
else
	@echo -e "$(YELLOW)âš ï¸  HAS_SHARED_LIBS not set - Logging will be disabled$(NC)"
endif
	@echo -e "$(GREEN)âœ… Shared libraries checked$(NC)"

# =============================================================================
# ğŸ”¥ ìƒˆë¡œìš´ ë””ë²„ê·¸ ì„¤ì • í™•ì¸ íƒ€ê²Ÿ
# =============================================================================

debug-config:
	@echo -e "$(BLUE)ğŸ” Export Gateway Debug Configuration:$(NC)"
	@echo "==========================================="
	@echo "Platform: $(PLATFORM)"
	@echo "Build Type: $(BUILD_TYPE)"
	@echo "PROJECT_ROOT: $(PROJECT_ROOT)"
	@echo "SHARED_DIR: $(SHARED_DIR)"
	@echo "SHARED_LIB_DIR: $(SHARED_LIB_DIR)"
	@echo "SHARED_INCLUDE_DIR: $(SHARED_INCLUDE_DIR)"
	@echo ""
	@echo "ğŸ” Library Detection Results:"
	@echo "  HAS_SHARED: $(HAS_SHARED)"
	@echo "  HAS_HIREDIS: $(HAS_HIREDIS)"
	@echo "  HAS_HTTPLIB: $(HAS_HTTPLIB)"
	@echo "  HAS_NLOHMANN_JSON: $(HAS_NLOHMANN_JSON)"
	@echo ""
	@echo "ğŸ”§ Compiler Flags:"
	@echo "$(CXXFLAGS)" | tr ' ' '\n' | grep -E '^-D' || echo "  (no defines)"
	@echo ""
	@echo "ğŸ“ Include Paths:"
	@echo "$(INCLUDES)" | tr ' ' '\n' | grep -E '^-I' || echo "  (no includes)"
	@echo ""
	@echo "ğŸ”— Library Paths:"
	@echo "$(LDFLAGS)" | tr ' ' '\n' | grep -E '^-[Ll]' || echo "  (no libraries)"
	@echo ""
	@echo "ğŸ“‹ File Status:"
	@ls -la "$(SHARED_LIB_DIR)/" 2>/dev/null || echo "  âš ï¸ Shared lib directory not accessible"

# =============================================================================
# ì‹¤í–‰ íŒŒì¼ ë¹Œë“œ
# =============================================================================

$(TARGET): $(ALL_OBJECTS) | $(BIN_DIR)
	@echo -e "$(GREEN)ğŸ”— Linking Export Gateway [$(BUILD_TYPE)]...$(NC)"
	@$(CXX) $(ALL_OBJECTS) -o $@ $(LDFLAGS)
	@echo -e "$(GREEN)âœ… Export Gateway built successfully: $@$(NC)"

# =============================================================================
# ì˜¤ë¸Œì íŠ¸ íŒŒì¼ ì»´íŒŒì¼
# =============================================================================

$(BUILD_DIR)/%.o: $(SRC_DIR)/%.cpp | $(BUILD_DIR)
	@mkdir -p $(dir $@)
	@echo -e "$(YELLOW)âš™ï¸ Compiling $< [$(BUILD_TYPE)]$(NC)"
	@$(CXX) $(CXXFLAGS) $(INCLUDES) -c $< -o $@

# =============================================================================
# í…ŒìŠ¤íŠ¸ íƒ€ê²Ÿë“¤ ğŸ”¥ ë³´ê°•
# =============================================================================

# CSP ì»´í¬ë„ŒíŠ¸ë§Œ í…ŒìŠ¤íŠ¸
test-csp: $(CSP_OBJECTS)
	@echo -e "$(BLUE)ğŸ§ª Testing CSP components...$(NC)"
	@echo -e "$(GREEN)âœ… CSP compilation test passed$(NC)"

# í—¤ë” íŒŒì¼ ë¬¸ë²• ê²€ì‚¬ (ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ)
test-headers:
	@echo -e "$(BLUE)ğŸ” Testing header files [$(PLATFORM)]...$(NC)"
	@echo "Testing CSP headers..."
	@if [ -f "$(INCLUDE_DIR)/CSP/AlarmMessage.h" ]; then \
		$(CXX) $(CXXFLAGS) $(INCLUDES) -fsyntax-only $(INCLUDE_DIR)/CSP/AlarmMessage.h && \
		echo "  âœ… AlarmMessage.h" || echo "  âŒ AlarmMessage.h"; \
	else \
		echo "  âš ï¸ AlarmMessage.h not found"; \
	fi
	@echo -e "$(GREEN)âœ… Header syntax check completed [$(PLATFORM)]$(NC)"

# ì „ì²´ ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸ (ë§í¬ ì—†ì´) ğŸ”¥ ë§¤í¬ë¡œ ì •ì˜ ìƒíƒœ í‘œì‹œ ì¶”ê°€
test-compile: $(ALL_OBJECTS)
	@echo -e "$(GREEN)âœ… All sources compiled successfully$(NC)"
	@echo -e "$(BLUE)ğŸ“‹ Compilation Summary:$(NC)"
	@echo "  Platform: $(PLATFORM)"
	@echo "  Build Type: $(BUILD_TYPE)"
	@echo "  HAS_SHARED: $(HAS_SHARED)"
ifeq ($(HAS_SHARED),1)
	@echo -e "  âœ… HAS_SHARED_LIBS=1 defined - LogManager available"
else
	@echo -e "  âš ï¸  HAS_SHARED_LIBS not defined - Logging disabled"
endif
	@echo "  Compiled objects: $(words $(ALL_OBJECTS))"

# =============================================================================
# ì‹¤í–‰ ë° ê°œë°œ íƒ€ê²Ÿë“¤
# =============================================================================

# ì‹¤í–‰
run: $(TARGET)
	@echo -e "$(BLUE)ğŸš€ Running Export Gateway...$(NC)"
	@cd $(BIN_DIR) && ./export-gateway

# ì„¤ì • íŒŒì¼ ìƒì„± (ê°œë°œìš©)
config:
	@echo -e "$(BLUE)âš™ï¸ Creating sample configuration...$(NC)"
	@mkdir -p config
	@echo '{ "csp_gateway": { "building_id": 1001, "debug_mode": true } }' > config/export_config.json
	@echo -e "$(GREEN)âœ… Sample config created: config/export_config.json$(NC)"

# =============================================================================
# í¬ë¡œìŠ¤ ì»´íŒŒì¼ ì§€ì› (sharedì™€ ë™ì¼ íŒ¨í„´)
# =============================================================================

# Windows í¬ë¡œìŠ¤ ì»´íŒŒì¼
windows-cross:
	@echo -e "$(YELLOW)ğŸ”§ Building Export Gateway for Windows (cross-compile)...$(NC)"
	$(MAKE) CROSS_COMPILE_WINDOWS=1 all

# =============================================================================
# ì •ë¦¬ ë° ìœ í‹¸ë¦¬í‹°
# =============================================================================

clean:
	@echo -e "$(YELLOW)ğŸ§¹ Cleaning export-gateway build files...$(NC)"
	@rm -rf $(BUILD_DIR) $(BIN_DIR)
	@echo -e "$(GREEN)âœ… Clean completed$(NC)"

clean-all: clean
	@echo -e "$(YELLOW)ğŸ§¹ Cleaning shared libraries...$(NC)"
	@cd $(SHARED_DIR) && $(MAKE) clean

# ì˜ì¡´ì„± ì •ë³´
deps-info:
	@echo -e "$(BLUE)ğŸ“‹ Export Gateway Dependencies$(NC)"
	@echo "=================================="
	@echo "Platform: $(PLATFORM)"
	@echo "Build Type: $(BUILD_TYPE)"
	@echo "Shared Dir: $(SHARED_DIR)"
	@echo "Include Paths:"
	@echo "  - $(INCLUDE_DIR)"
	@echo "  - $(SHARED_INCLUDE_DIR)"
	@echo ""
	@echo "Required Libraries:"
	@echo "  - PulseOne Shared (common, database, client, export, alarm)"
	@echo "  - hiredis (Redis client)"
	@echo "  - libcurl (HTTP/S3 client)"
	@echo "  - nlohmann/json (JSON processing)"

# ë¹Œë“œ ìƒíƒœ í™•ì¸
status:
	@echo -e "$(BLUE)ğŸ“Š Export Gateway Build Status$(NC)"
	@echo "=============================="
	@echo "Target: $(if $(wildcard $(TARGET)),$(GREEN)âœ… Built$(NC),$(RED)âŒ Not built$(NC))"
	@echo "Source files: $(words $(CSP_SOURCES) $(EXPORT_SOURCES) $(UTILS_SOURCES) $(MAIN_SOURCES))"
	@echo "Object files: $(if $(wildcard $(BUILD_DIR)/*.o),$(words $(wildcard $(BUILD_DIR)/*/*.o)),0)"
	@echo "Shared libs: $(if $(wildcard $(SHARED_LIB_DIR)/*.a),$(GREEN)âœ… Available$(NC),$(RED)âŒ Missing$(NC))"

# ë„ì›€ë§
help:
	@echo -e "$(BLUE)ğŸš€ PulseOne Export Gateway Makefile$(NC)"
	@echo "====================================="
	@echo ""
	@echo -e "$(GREEN)Main Targets:$(NC)"
	@echo "  make all          - Build export gateway (default)"
	@echo "  make debug        - Build in debug mode"
	@echo "  make release      - Build in release mode"
	@echo "  make run          - Build and run export gateway"
	@echo ""
	@echo -e "$(GREEN)Testing:$(NC)"
	@echo "  make test-csp     - Test CSP components only"
	@echo "  make test-headers - Test header file syntax"
	@echo "  make test-compile - Test compilation without linking"
	@echo ""
	@echo -e "$(GREEN)Development:$(NC)"
	@echo "  make config       - Create sample configuration"
	@echo "  make debug-config - Show detailed configuration"
	@echo "  make deps-info    - Show dependency information"
	@echo "  make status       - Show build status"
	@echo ""
	@echo -e "$(GREEN)Utilities:$(NC)"
	@echo "  make clean        - Clean build files"
	@echo "  make clean-all    - Clean everything including shared libs"
	@echo "  make help         - Show this help"
	@echo ""
	@echo -e "$(YELLOW)Build Types:$(NC)"
	@echo "  BUILD_TYPE=Debug  - Debug build with symbols"
	@echo "  BUILD_TYPE=Release - Optimized release build (default)"
	@echo ""
	@echo -e "$(YELLOW)Current Settings:$(NC)"
	@echo "  Platform: $(PLATFORM)"
	@echo "  Build Type: $(BUILD_TYPE)"
	@echo "  Shared Dir: $(SHARED_DIR)"

.DEFAULT_GOAL := all